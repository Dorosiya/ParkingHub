<!DOCTYPE html>
<html>
<head>
    <title>업데이트된 스마트 주차 가이드 데이터베이스 테이블 명세서 - 2부</title>
    <style>
        body { font-family: Arial, sans-serif; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
        th, td { border: 1px solid #dddddd; text-align: left; padding: 8px; }
        th { background-color: #f2f2f2; }
        h1 { color: #333; }
        h2 { color: #555; margin-top: 30px; }
        .note { background-color: #f9f9f9; padding: 10px; border-left: 4px solid #ddd; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>업데이트된 스마트 주차 가이드 데이터베이스 테이블 명세서 - 2부</h1>

    <h2>8. 리뷰(REVIEW)</h2>
    <table>
        <tr>
            <th>필드명</th>
            <th>데이터 타입</th>
            <th>설명</th>
            <th>키</th>
            <th>제약조건</th>
        </tr>
        <tr>
            <td>id</td>
            <td>int</td>
            <td>리뷰 ID</td>
            <td>PK</td>
            <td>자동증가(AUTO_INCREMENT)</td>
        </tr>
        <tr>
            <td>user_id</td>
            <td>int</td>
            <td>사용자 ID</td>
            <td>FK</td>
            <td>NOT NULL, REFERENCES USER(id)</td>
        </tr>
        <tr>
            <td>parking_code</td>
            <td>varchar(50)</td>
            <td>주차장 코드</td>
            <td>FK</td>
            <td>NOT NULL, REFERENCES PARKING_INFO(prk_center_id)</td>
        </tr>
        <tr>
            <td>rating</td>
            <td>decimal(2,1)</td>
            <td>별점 (0-5)</td>
            <td></td>
            <td>NOT NULL, CHECK (rating BETWEEN 0 AND 5)</td>
        </tr>
        <tr>
            <td>comment</td>
            <td>varchar(1000)</td>
            <td>리뷰 내용</td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td>created_at</td>
            <td>datetime</td>
            <td>생성일시</td>
            <td></td>
            <td>DEFAULT CURRENT_TIMESTAMP</td>
        </tr>
    </table>
    <div class="note">
        <p><strong>추가 설명:</strong> 이 테이블은 사용자가 주차장에 대해 작성한 리뷰와 별점을 저장합니다. rating 필드는 0.5 단위로 별점을 입력할 수 있도록 decimal(2,1) 타입을 사용합니다. 사용자당 주차장 하나에 대해 하나의 리뷰만 작성할 수 있도록 user_id와 parking_code의 조합에 UNIQUE 제약조건을 추가했습니다. TEXT 대신 VARCHAR(1000)을 사용하여 저장 공간과 성능을 최적화했습니다.</p>
    </div>

    <h2>9. 사용자 방문 기록(USER_HISTORY)</h2>
    <table>
        <tr>
            <th>필드명</th>
            <th>데이터 타입</th>
            <th>설명</th>
            <th>키</th>
            <th>제약조건</th>
        </tr>
        <tr>
            <td>id</td>
            <td>int</td>
            <td>방문 기록 ID</td>
            <td>PK</td>
            <td>자동증가(AUTO_INCREMENT)</td>
        </tr>
        <tr>
            <td>user_id</td>
            <td>int</td>
            <td>사용자 ID</td>
            <td>FK</td>
            <td>NOT NULL, REFERENCES USER(id)</td>
        </tr>
        <tr>
            <td>parking_code</td>
            <td>varchar(50)</td>
            <td>주차장 코드</td>
            <td>FK</td>
            <td>NOT NULL, REFERENCES PARKING_INFO(prk_center_id)</td>
        </tr>
        <tr>
            <td>visited_at</td>
            <td>datetime</td>
            <td>방문 일시</td>
            <td></td>
            <td>NOT NULL, DEFAULT CURRENT_TIMESTAMP</td>
        </tr>
    </table>
    <div class="note">
        <p><strong>추가 설명:</strong> 이 테이블은 사용자의 주차장 방문 기록을 저장합니다. 주차장 디테일 페이지 조회, 주차 정보 조회 등의 활동을 기록할 수 있습니다. 이 데이터는 사용자에게 '최근 방문 주차장' 기능을 제공하고, 데이터 분석에도 활용할 수 있습니다. (user_id, visited_at) 조합에 인덱스를 추가하여 최근 방문 조회 성능을 향상시켰습니다.</p>
    </div>

    <h2>10. 알림 설정(ALERT_SETTING)</h2>
    <table>
        <tr>
            <th>필드명</th>
            <th>데이터 타입</th>
            <th>설명</th>
            <th>키</th>
            <th>제약조건</th>
        </tr>
        <tr>
            <td>id</td>
            <td>int</td>
            <td>알림 설정 ID</td>
            <td>PK</td>
            <td>자동증가(AUTO_INCREMENT)</td>
        </tr>
        <tr>
            <td>user_id</td>
            <td>int</td>
            <td>사용자 ID</td>
            <td>FK</td>
            <td>NOT NULL, REFERENCES USER(id)</td>
        </tr>
        <tr>
            <td>parking_code</td>
            <td>varchar(50)</td>
            <td>주차장 코드</td>
            <td>FK</td>
            <td>NOT NULL, REFERENCES PARKING_INFO(prk_center_id)</td>
        </tr>
        <tr>
            <td>day_of_week</td>
            <td>varchar(3)</td>
            <td>요일</td>
            <td></td>
            <td>NOT NULL, CHECK(day_of_week IN ('SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT', 'HOL'))</td>
        </tr>
        <tr>
            <td>hour</td>
            <td>int</td>
            <td>시간(24시간)</td>
            <td></td>
            <td>NOT NULL, CHECK (hour BETWEEN 0 AND 23)</td>
        </tr>
        <tr>
            <td>min_free_slots</td>
            <td>int</td>
            <td>최소 가용 주차공간</td>
            <td></td>
            <td>NOT NULL, CHECK (min_free_slots > 0)</td>
        </tr>
    </table>
    <div class="note">
        <p><strong>추가 설명:</strong> 이 테이블은 사용자가 설정한 주차 공간 가용성 알림 조건을 저장합니다. 예를 들어, 특정 주차장에 월요일 9시에 최소 5개 이상의 주차공간이 가용할 경우 알림을 받도록 설정할 수 있습니다. ENUM 타입 대신 VARCHAR(3)에 CHECK 제약 조건을 사용하여 요일 데이터를 저장합니다. (day_of_week, hour) 조합에 인덱스를 추가하여 알림 조건 검색 성능을 향상시켰습니다.</p>
    </div>

    <h2>11. 게시글(POST)</h2>
    <table>
        <tr>
            <th>필드명</th>
            <th>데이터 타입</th>
            <th>설명</th>
            <th>키</th>
            <th>제약조건</th>
        </tr>
        <tr>
            <td>id</td>
            <td>int</td>
            <td>게시글 ID</td>
            <td>PK</td>
            <td>자동증가(AUTO_INCREMENT)</td>
        </tr>
        <tr>
            <td>user_id</td>
            <td>int</td>
            <td>사용자 ID</td>
            <td>FK</td>
            <td>NOT NULL, REFERENCES USER(id)</td>
        </tr>
        <tr>
            <td>title</td>
            <td>varchar(200)</td>
            <td>제목</td>
            <td></td>
            <td>NOT NULL</td>
        </tr>
        <tr>
            <td>content</td>
            <td>text</td>
            <td>내용</td>
            <td></td>
            <td>NOT NULL</td>
        </tr>
        <tr>
            <td>views</td>
            <td>int</td>
            <td>조회수</td>
            <td></td>
            <td>NOT NULL, DEFAULT 0</td>
        </tr>
        <tr>
            <td>created_at</td>
            <td>datetime</td>
            <td>생성일시</td>
            <td></td>
            <td>DEFAULT CURRENT_TIMESTAMP</td>
        </tr>
    </table>
    <div class="note">
        <p><strong>추가 설명:</strong> 이 테이블은 커뮤니티 게시판의 게시글을 저장합니다. 사용자들이 주차 팁이나 경험을 공유할 수 있는 게시판으로 활용됩니다. 게시글 내용은 TEXT 타입을 사용하여 길이 제한 없이 저장할 수 있습니다. created_at에 인덱스를 추가하여 최신 글 조회 성능을 향상시켰습니다.</p>
    </div>

    <h2>12. 댓글(COMMENT)</h2>
    <table>
        <tr>
            <th>필드명</th>
            <th>데이터 타입</th>
            <th>설명</th>
            <th>키</th>
            <th>제약조건</th>
        </tr>
        <tr>
            <td>id</td>
            <td>int</td>
            <td>댓글 ID</td>
            <td>PK</td>
            <td>자동증가(AUTO_INCREMENT)</td>
        </tr>
        <tr>
            <td>post_id</td>
            <td>int</td>
            <td>게시글 ID</td>
            <td>FK</td>
            <td>NOT NULL, REFERENCES POST(id)</td>
        </tr>
        <tr>
            <td>user_id</td>
            <td>int</td>
            <td>사용자 ID</td>
            <td>FK</td>
            <td>NOT NULL, REFERENCES USER(id)</td>
        </tr>
        <tr>
            <td>comment</td>
            <td>varchar(1000)</td>
            <td>댓글 내용</td>
            <td></td>
            <td>NOT NULL</td>
        </tr>
        <tr>
            <td>created_at</td>
            <td>datetime</td>
            <td>생성일시</td>
            <td></td>
            <td>DEFAULT CURRENT_TIMESTAMP</td>
        </tr>
    </table>
    <div class="note">
        <p><strong>추가 설명:</strong> 이 테이블은 게시글에 대한 댓글을 저장합니다. 댓글 내용은 VARCHAR(1000)을 사용하여 저장 공간과 성능을 최적화했습니다. 필요에 따라 대댓글 기능을 추가하려면 parent_id 컬럼을 추가할 수 있습니다.</p>
    </div>

    <h2>13. 관리자(ADMIN)</h2>
    <table>
        <tr>
            <th>필드명</th>
            <th>데이터 타입</th>
            <th>설명</th>
            <th>키</th>
            <th>제약조건</th>
        </tr>
        <tr>
            <td>admin_id</td>
            <td>int</td>
            <td>관리자 ID</td>
            <td>PK</td>
            <td>자동증가(AUTO_INCREMENT)</td>
        </tr>
        <tr>
            <td>admin_email</td>
            <td>varchar(100)</td>
            <td>관리자 이메일</td>
            <td></td>
            <td>NOT NULL, UNIQUE</td>
        </tr>
        <tr>
            <td>password</td>
            <td>varchar(100)</td>
            <td>비밀번호</td>
            <td></td>
            <td>NOT NULL</td>
        </tr>
        <tr>
            <td>created_at</td>
            <td>datetime</td>
            <td>생성일시</td>
            <td></td>
            <td>DEFAULT CURRENT_TIMESTAMP</td>
        </tr>
    </table>
    <div class="note">
        <p><strong>추가 설명:</strong> 이 테이블은 관리자 계정 정보를 저장합니다. 관리자는 리뷰, 게시글, 댓글 등의 콘텐츠를 관리하고 필요시 삭제할 수 있는 권한을 가집니다. 보안을 위해 비밀번호는 해시화하여 저장해야 합니다. 필요에 따라 관리자 권한 수준을 나타내는 role 필드를 추가할 수 있습니다.</p>
    </div>

    <h2>테이블 관계도 요약</h2>
    <div class="note">
        <p><strong>주요 관계:</strong></p>
        <ul>
            <li><strong>사용자(USER) 중심 관계:</strong> 한 사용자는 여러 즐겨찾기, 리뷰, 방문기록, 알림설정, 게시글, 댓글을 가질 수 있습니다(1:N 관계).</li>
            <li><strong>주차장(PARKING_INFO) 중심 관계:</strong> 
                <ul>
                    <li>한 주차장은 하나의 운영정보, 요금정보, 실시간 정보를 가집니다(1:1 관계).</li>
                    <li>한 주차장은 여러 운영시간 레코드를 가집니다(요일별 1:N 관계).</li>
                    <li>한 주차장은 여러 즐겨찾기, 리뷰, 방문기록, 알림설정에 연결될 수 있습니다(1:N 관계).</li>
                </ul>
            </li>
            <li><strong>게시글(POST)-댓글(COMMENT) 관계:</strong> 한 게시글은 여러 댓글을 가질 수 있습니다(1:N 관계).</li>
        </ul>
        <p><strong>인덱스:</strong> 위치 검색, 별점 조회, 최신 게시글 조회, 알림 조건 검색, 최근 방문 조회 등의 성능 향상을 위해 적절한 인덱스가 추가되었습니다.</p>
    </div>
</body>
</html>
